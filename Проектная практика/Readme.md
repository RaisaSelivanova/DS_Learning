# Модель обнаружения пожаров

## Краткое описание модели и назначение
В рамках данного проекта используется модель Forest-Fire-Detection из ресурса Hugging Face. 
Ссылка на модель: https://huggingface.co/prithivMLmods/Forest-Fire-Detection

Forest-Fire-Detection  -  это дообученная модель компьютерного зрения на основе архитектуры SigLIP, которая анализирует изображения для классификации лесных сцен на три категории:
- fire - наличие явных визуальных признаков пожара/открытого огня
- smoke - наличие задымления
- normal - нормальная ситуация

##### Предназначение модели:

Модель предназначена для автоматического мониторинга лесных территорий по данным с:
- наземных камер наблюдения
- БПЛА/дронов, обеспечивающих снимки с относительно малой высоты

##### Практическая ценность модели:

 - раннее обнаружение признаков пожара/задымления в лесу, что позволит оперативно произвести тушение, предотвратив распространение возгорания на большую площадь территории
 - поддержка принятия решений при реагировании на ЧС: в части необходимости эвакуации, объема ресурсов на пожаротушение, приоритетности реагирования
 - аналитическая ценность: анализ архивных и текущих визуальных данных позволит оценить пожароопасность на исследуемых лесных территориях

## Технические детали

По ссылке https://huggingface.co/prithivMLmods/Forest-Fire-Detection/blob/main/README.md можно найти технические детали, включая Install Dependencies и Inference Code. 

## Цель и задачи проекта 
Применить указанную предобученную модель ML к тестовым данным. Проанализировать результат, оценить качество модели, оформить выводы и рекомендации.

## Этапы проекта
### 1.Подготовка
- загрузка модели
- подготовка тестового набора данных: использовано 21 изображение леса - по 7 фото каждого класса (fire, smoke, normal)
ссылка на датасет: https://github.com/RaisaSelivanova/Forest_fire_detection/tree/main/Photo
- установка необходимых библиотек (transformers, torch, scikit-learn, matplotlib...)

### 2. Получение результата модели и оценка качества
Ссылка на файл с кодом: https://github.com/RaisaSelivanova/Forest_fire_detection/blob/main/Forest_fire_detection.ipynb
#### 2.1. Первоначальное тестирование
- каждое изображение обработано моделью с получением вероятностей для всех классов
- визуализированы 3 фото с результатами модели для демонстрации работы модели
- анализ качества: выявлена проблема — низкое качество распознавания класса "Smoke"
Использовались метрики качества:
Accuracy: 71.4% (15 из 21 правильных предсказаний) - классы сбалансированы, поэтому данная метрика подходит
Детали:
Класс "Fire": все 7 случаев распознаны верно
Класс "Normal": все 7 случаев распознаны верно
Класс "Smoke": только 1 из 7 случаев распознан верно

На Hugging face представлены данные, по которым обучалась модель: https://huggingface.co/datasets/Shravanig/fire_detection_final
Проанализировав эти данные, пришли к выводу, что причина плохого качества распознавания класса "Smoke" в том, что для обучения модели с меткой "Smoke" использовалась фото одного и того же пейзажа, с дымом одной и той же формы, только расположенного в разных частях фотографии. 
Также для обучения использовались фото с меткой "Fire" без визуальных признаков огня - только дым.

#### 2.2.Тестирование с бинарной классификацией
Т.к. наибольшую практическую ценность имеет обнаружение тревожных сигналов, объединили классы "Fire" и "Smoke" в один - "Тревога" и протестировали модель по данной логике.
 - при такой формулировке задаче ошибки сократились с 6 до 3 случаев (правильных предсказаний 18 из 21)
 - проанализировали метрики качества. Наиболее критична метрика recall - 78,6%. Она говорит о том, что 21,4% тревожных случаев были пропущены. Это говорит о необходимости улучшений модели/подхода к использованию модели
 -детально исследовали случаи ошибок: в двух случаях из трех модель не имела высокой уверенности в классе (52,1% уверенность в одном случае и 70,7% во втором). В третьем случае была высокая уверенность (98,8%), но на фото дым был слабо различим

### 3. Рекомендации и выводы
1. Для текущего использования рекомендуется двухуровневая система: автоматическое принятие решений только при уверенности более  
90%, остальные случаи — ручная проверка оператором, особенно в пожароопасные периоды
2. В дальнейшем рекомендовано дообучение модели для лучшего распознавания дыма с ипользованием фото:
- дыма в лесу в сложных погодных условиях (туман, например)
- дыма в лесу, который слабо виден
- которые попали на ручную проверку оператору (что позволит усовершенствовать датасет для последующего обучения модели)

## Примеры определения классов модели:
Ниже приведены результаты классификации, описанной в п. 2.2.
- Дым_1.jpg результат - "Тревога" (75.3% уверенности, изначально классифицирован как Fire, истинное значение - "Smoke"/"Тревога")
- Есть пожар_1.jpg результат - "Тревога" (100% уверенности, изначально классифицирован как Fire, истинное значение - "Fire"/"Тревога")
- Нет пожара_1.jpg результат - "Норма" (99,8% уверенности, изначально классифицирован как Normal, истинное значение - "Normal"/"Норма")


## Состав репозитория
Данные для тестирования модели - https://github.com/RaisaSelivanova/Forest_fire_detection/tree/main/Photo
Основной файл с кодом, визуализацями и выводами - https://github.com/RaisaSelivanova/Forest_fire_detection/blob/main/Forest_fire_detection.ipynb
Readme - https://github.com/RaisaSelivanova/Forest_fire_detection/blob/main/Readme.md

## Инструкция по запуску:
1. Скачайте проект
- первый способ:
bash
git clone https://github.com/RaisaSelivanova/Forest_fire_detection.git
- второй способ:
    - откройте https://github.com/RaisaSelivanova/Forest_fire_detection
    - нажмите  кнопку "Code" далее "Download ZIP" 
    - распакуйте архив на компьютер
2. Установите необходимые библиотеки:
bash
pip install transformers torch pillow scikit-learn matplotlib seaborn tabulate jupyter    
3. Запуск проекта:
   3.1. В Jupyter Notebook:
        bash
        jupyter notebook Forest_fire_detection.ipynb
   3.2. В Google collab:
        - откройте https://colab.research.google.com/
        - нажмите "Загрузить" далее "GitHub"
        - вставьте ссылку: https://github.com/RaisaSelivanova/Forest_fire_detection
        - выберите Forest_fire_detection.ipynb   
   3.3.  VS Code, PyCharm, Spyder:
       - откройте папку проекта в вашей IDE
       - найдите и откройте файл Forest_fire_detection.ipynb
       - запускайте ячейки по порядку

После запуска:
- скачается модель
- проанализируются 21 тестовое изображение из папки Photo и будут определены классы 
- появятся таблицы с результатами и графики, отражающие метрики качества
- будет рассчитана точность модели и даны рекомендации       





